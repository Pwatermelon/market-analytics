"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
–ó–∞–ø–æ–ª–Ω—è–µ—Ç –±–∞–∑—É —Ç–µ—Å—Ç–æ–≤—ã–º —Ç–æ–≤–∞—Ä–æ–º —Å 30 –æ—Ç–∑—ã–≤–∞–º–∏ —Ä–∞–∑–Ω–æ–π —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
"""
import os
import sys
from datetime import datetime, timedelta
from sqlalchemy import create_engine, text
from sqlalchemy.orm import sessionmaker

# –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç—å –∫ –º–æ–¥—É–ª—è–º
sys.path.insert(0, os.path.dirname(os.path.abspath(__file__)))

from main import Product, Review, Base

DATABASE_URL = os.getenv("DATABASE_URL", "postgresql://postgres:postgres@postgres:5432/market_analytics")
engine = create_engine(DATABASE_URL)
SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)

# –¢–µ—Å—Ç–æ–≤—ã–µ –æ—Ç–∑—ã–≤—ã —Å —Ä–∞–∑–Ω–æ–π —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é
TEST_REVIEWS = [
    # –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ (5 –∑–≤–µ–∑–¥)
    {"rating": 5, "text": "–û—Ç–ª–∏—á–Ω—ã–π —Ç–æ–≤–∞—Ä! –û—á–µ–Ω—å –¥–æ–≤–æ–ª–µ–Ω –ø–æ–∫—É–ø–∫–æ–π. –ö–∞—á–µ—Å—Ç–≤–æ –Ω–∞ –≤—ã—Å–æ—Ç–µ, –¥–æ—Å—Ç–∞–≤–∫–∞ –±—ã—Å—Ç—Ä–∞—è. –†–µ–∫–æ–º–µ–Ω–¥—É—é –≤—Å–µ–º!", "author": "–ò–≤–∞–Ω –ü."},
    {"rating": 5, "text": "–ü—Ä–µ–∫—Ä–∞—Å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ, –≤—Å–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—é. –£–ø–∞–∫–æ–≤–∫–∞ —Ü–µ–ª–∞—è, —Ç–æ–≤–∞—Ä –≤ –∏–¥–µ–∞–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏. –°–ø–∞—Å–∏–±–æ!", "author": "–ú–∞—Ä–∏—è –ö."},
    {"rating": 5, "text": "–°—É–ø–µ—Ä —Ç–æ–≤–∞—Ä! –ü—Ä–µ–≤–∑–æ—à–µ–ª –≤—Å–µ –æ–∂–∏–¥–∞–Ω–∏—è. –ü–æ–ª—å–∑—É—é—Å—å —É–∂–µ –º–µ—Å—è—Ü, –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ. –û—á–µ–Ω—å —Ä–µ–∫–æ–º–µ–Ω–¥—É—é!", "author": "–ê–ª–µ–∫—Å–µ–π –°."},
    {"rating": 5, "text": "–ó–∞–º–µ—á–∞—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç! –ö–∞—á–µ—Å—Ç–≤–æ –æ—Ç–ª–∏—á–Ω–æ–µ, —Ü–µ–Ω–∞ –∞–¥–µ–∫–≤–∞—Ç–Ω–∞—è. –ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞, –≤–µ–∂–ª–∏–≤—ã–µ –∫—É—Ä—å–µ—Ä—ã.", "author": "–ï–ª–µ–Ω–∞ –í."},
    {"rating": 5, "text": "–õ—É—á—à–∞—è –ø–æ–∫—É–ø–∫–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è! –í—Å–µ –Ω–∞ –≤—ã—Å—à–µ–º —É—Ä–æ–≤–Ω–µ, –Ω–∏–∫–∞–∫–∏—Ö –Ω–∞—Ä–µ–∫–∞–Ω–∏–π. –ë—É–¥—É –∑–∞–∫–∞–∑—ã–≤–∞—Ç—å –µ—â–µ!", "author": "–î–º–∏—Ç—Ä–∏–π –†."},
    
    # –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ (4 –∑–≤–µ–∑–¥—ã)
    {"rating": 4, "text": "–•–æ—Ä–æ—à–∏–π —Ç–æ–≤–∞—Ä, –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ. –ï—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∏–µ –Ω–µ–¥–æ—á–µ—Ç—ã, –Ω–æ –≤ —Ü–µ–ª–æ–º –¥–æ–≤–æ–ª–µ–Ω. –†–µ–∫–æ–º–µ–Ω–¥—É—é.", "author": "–û–ª—å–≥–∞ –ú."},
    {"rating": 4, "text": "–ù–µ–ø–ª–æ—Ö–æ–π –ø—Ä–æ–¥—É–∫—Ç –∑–∞ —Å–≤–æ—é —Ü–µ–Ω—É. –ö–∞—á–µ—Å—Ç–≤–æ —Ö–æ—Ä–æ—à–µ–µ, –Ω–æ –µ—Å—Ç—å —á—Ç–æ —É–ª—É—á—à–∏—Ç—å. –î–æ—Å—Ç–∞–≤–∫–∞ –±—ã—Å—Ç—Ä–∞—è.", "author": "–°–µ—Ä–≥–µ–π –ù."},
    {"rating": 4, "text": "–í —Ü–µ–ª–æ–º —Ç–æ–≤–∞—Ä —Ö–æ—Ä–æ—à–∏–π, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—é. –ù–µ–±–æ–ª—å—à–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è –ø–æ —É–ø–∞–∫–æ–≤–∫–µ, –Ω–æ —ç—Ç–æ –º–µ–ª–æ—á–∏.", "author": "–ê–Ω–Ω–∞ –¢."},
    {"rating": 4, "text": "–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–æ–≤–∞—Ä, —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –∑–∞—è–≤–ª–µ–Ω–æ. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –º–∏–Ω—É—Å - –¥–æ–ª–≥–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞, –Ω–æ —ç—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ.", "author": "–ü–∞–≤–µ–ª –õ."},
    {"rating": 4, "text": "–•–æ—Ä–æ—à–µ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ü–µ–Ω–∞-–∫–∞—á–µ—Å—Ç–≤–æ. –¢–æ–≤–∞—Ä —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–Ω–∏—è–º, —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –∫ –ø–æ–∫—É–ø–∫–µ.", "author": "–¢–∞—Ç—å—è–Ω–∞ –ì."},
    
    # –ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ (3 –∑–≤–µ–∑–¥—ã)
    {"rating": 3, "text": "–°—Ä–µ–¥–Ω–∏–π —Ç–æ–≤–∞—Ä, –Ω–∏—á–µ–≥–æ –æ—Å–æ–±–µ–Ω–Ω–æ–≥–æ. –ö–∞—á–µ—Å—Ç–≤–æ —Å—Ä–µ–¥–Ω–µ–µ, —Ü–µ–Ω–∞ –∑–∞–≤—ã—à–µ–Ω–∞ –Ω–∞ –º–æ–π –≤–∑–≥–ª—è–¥. –ú–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –ª—É—á—à–µ.", "author": "–ù–∏–∫–æ–ª–∞–π –ë."},
    {"rating": 3, "text": "–û–±—ã—á–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç, –æ–∂–∏–¥–∞–ª –±–æ–ª—å—à–µ–≥–æ. –†–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –µ—Å—Ç—å –±–æ–ª–µ–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∞–Ω–∞–ª–æ–≥–∏ –Ω–∞ —Ä—ã–Ω–∫–µ.", "author": "–Æ–ª–∏—è –î."},
    {"rating": 3, "text": "–¢–æ–≤–∞—Ä –∫–∞–∫ —Ç–æ–≤–∞—Ä, –Ω–∏—á–µ–≥–æ –≤—ã–¥–∞—é—â–µ–≥–æ—Å—è. –ö–∞—á–µ—Å—Ç–≤–æ —Å—Ä–µ–¥–Ω–µ–µ, —Ü–µ–Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è. –ü–æ–¥–æ–π–¥–µ—Ç –¥–ª—è –±–∞–∑–æ–≤—ã—Ö –Ω—É–∂–¥.", "author": "–ú–∏—Ö–∞–∏–ª –ñ."},
    {"rating": 3, "text": "–°—Ä–µ–¥–Ω–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ü–µ–Ω–µ. –ï—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏, –Ω–æ –≤ —Ü–µ–ª–æ–º –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.", "author": "–ù–∞—Ç–∞–ª—å—è –ó."},
    {"rating": 3, "text": "–ù–æ—Ä–º–∞–ª—å–Ω—ã–π —Ç–æ–≤–∞—Ä, –Ω–æ –Ω–µ –±–æ–ª–µ–µ —Ç–æ–≥–æ. –û–∂–∏–¥–∞–ª –ª—É—á—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ –∑–∞ —Ç–∞–∫—É—é —Ü–µ–Ω—É. –í —Ü–µ–ª–æ–º —Å–æ–π–¥–µ—Ç.", "author": "–í–ª–∞–¥–∏–º–∏—Ä –ö."},
    
    # –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ (2 –∑–≤–µ–∑–¥—ã)
    {"rating": 2, "text": "–†–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω –ø–æ–∫—É–ø–∫–æ–π. –ö–∞—á–µ—Å—Ç–≤–æ –æ—Å—Ç–∞–≤–ª—è–µ—Ç –∂–µ–ª–∞—Ç—å –ª—É—á—à–µ–≥–æ, —Ç–æ–≤–∞—Ä –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—é. –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é.", "author": "–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞ –ü."},
    {"rating": 2, "text": "–ü–ª–æ—Ö–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ, —Ç–æ–≤–∞—Ä —Å–ª–æ–º–∞–ª—Å—è —á–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é. –î–æ—Å—Ç–∞–≤–∫–∞ –±—ã–ª–∞ –¥–æ–ª–≥–æ–π, —É–ø–∞–∫–æ–≤–∫–∞ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞. –û—á–µ–Ω—å –Ω–µ–¥–æ–≤–æ–ª–µ–Ω.", "author": "–ê–Ω–¥—Ä–µ–π –°."},
    {"rating": 2, "text": "–ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é. –¢–æ–≤–∞—Ä –Ω–µ –æ–ø—Ä–∞–≤–¥–∞–ª –æ–∂–∏–¥–∞–Ω–∏–π, –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∏–∑–∫–æ–µ. –õ—É—á—à–µ –ø–æ–∏—Å–∫–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É.", "author": "–ò—Ä–∏–Ω–∞ –í."},
    {"rating": 2, "text": "–û—á–µ–Ω—å —Ä–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω. –¢–æ–≤–∞—Ä –ø—Ä–∏—à–µ–ª —Å –¥–µ—Ñ–µ–∫—Ç–∞–º–∏, –∫–∞—á–µ—Å—Ç–≤–æ —É–∂–∞—Å–Ω–æ–µ. –ü–æ—Ç—Ä–∞—Ç–∏–ª –¥–µ–Ω—å–≥–∏ –≤–ø—É—Å—Ç—É—é.", "author": "–†–æ–º–∞–Ω –ú."},
    {"rating": 2, "text": "–ü–ª–æ—Ö–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ, –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ñ–æ—Ç–æ. –¢–æ–≤–∞—Ä –≤—ã–≥–ª—è–¥–∏—Ç –¥–µ—à–µ–≤–æ, –±—ã—Å—Ç—Ä–æ –ø—Ä–∏—à–µ–ª –≤ –Ω–µ–≥–æ–¥–Ω–æ—Å—Ç—å.", "author": "–°–≤–µ—Ç–ª–∞–Ω–∞ –ù."},
    
    # –û—á–µ–Ω—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ (1 –∑–≤–µ–∑–¥–∞)
    {"rating": 1, "text": "–£–∂–∞—Å–Ω—ã–π —Ç–æ–≤–∞—Ä! –ü–æ–ª–Ω—ã–π —Ä–∞–∑–≤–æ–¥. –ö–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤—Ä–∞—Ç–∏—Ç–µ–ª—å–Ω–æ–µ, —Ç–æ–≤–∞—Ä —Å–ª–æ–º–∞–ª—Å—è —Å—Ä–∞–∑—É. –ù–∏–∫–æ–º—É –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é!", "author": "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –¢."},
    {"rating": 1, "text": "–•—É–¥—à–∞—è –ø–æ–∫—É–ø–∫–∞ –≤ –∂–∏–∑–Ω–∏! –¢–æ–≤–∞—Ä –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∫–∞—á–µ—Å—Ç–≤–æ –Ω—É–ª–µ–≤–æ–µ. –ü–æ—Ç—Ä–∞—Ç–∏–ª –¥–µ–Ω—å–≥–∏ –∑—Ä—è, –æ—á–µ–Ω—å –∂–∞–ª—å.", "author": "–û–∫—Å–∞–Ω–∞ –õ."},
    {"rating": 1, "text": "–ü–æ–ª–Ω—ã–π –∫–æ—à–º–∞—Ä! –¢–æ–≤–∞—Ä –ø—Ä–∏—à–µ–ª —Å–ª–æ–º–∞–Ω–Ω—ã–º, –∫–∞—á–µ—Å—Ç–≤–æ —É–∂–∞—Å–Ω–æ–µ. –ù–∏–∫–æ–≥–¥–∞ –±–æ–ª—å—à–µ –Ω–µ –±—É–¥—É –∑–∞–∫–∞–∑—ã–≤–∞—Ç—å –∑–¥–µ—Å—å.", "author": "–í–∏–∫—Ç–æ—Ä –ì."},
    {"rating": 1, "text": "–û—Ç–≤—Ä–∞—Ç–∏—Ç–µ–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ! –¢–æ–≤–∞—Ä –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—é, —Å–ª–æ–º–∞–ª—Å—è —á–µ—Ä–µ–∑ –¥–µ–Ω—å. –û—á–µ–Ω—å –Ω–µ–¥–æ–≤–æ–ª–µ–Ω –ø–æ–∫—É–ø–∫–æ–π.", "author": "–õ—é–¥–º–∏–ª–∞ –ë."},
    {"rating": 1, "text": "–£–∂–∞—Å! –¢–æ–≤–∞—Ä –ø–æ–ª–Ω–æ–µ –¥–µ—Ä—å–º–æ, –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–æ–æ–±—â–µ. –ü–æ—Ç—Ä–∞—Ç–∏–ª –¥–µ–Ω—å–≥–∏ –≤–ø—É—Å—Ç—É—é, –æ—á–µ–Ω—å —Ä–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω.", "author": "–ì–µ–Ω–Ω–∞–¥–∏–π –î."},
    
    # –°–º–µ—à–∞–Ω–Ω—ã–µ –æ—Ç–∑—ã–≤—ã
    {"rating": 4, "text": "–•–æ—Ä–æ—à–∏–π —Ç–æ–≤–∞—Ä, –Ω–æ –µ—Å—Ç—å –Ω—é–∞–Ω—Å—ã. –ö–∞—á–µ—Å—Ç–≤–æ –≤ —Ü–µ–ª–æ–º –Ω–µ–ø–ª–æ—Ö–æ–µ, –Ω–æ —É–ø–∞–∫–æ–≤–∫–∞ –º–æ–≥–ª–∞ –±—ã –±—ã—Ç—å –ª—É—á—à–µ. –†–µ–∫–æ–º–µ–Ω–¥—É—é —Å –æ–≥–æ–≤–æ—Ä–∫–∞–º–∏.", "author": "–ï–≤–≥–µ–Ω–∏–π –ñ."},
    {"rating": 3, "text": "–¢–æ–≤–∞—Ä —Å—Ä–µ–¥–Ω–∏–π, –Ω–∏—á–µ–≥–æ –æ—Å–æ–±–µ–Ω–Ω–æ–≥–æ. –ü–æ–¥–æ–π–¥–µ—Ç –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –Ω–æ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –ª—É—á—à–µ –ø–æ–∏—Å–∫–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É.", "author": "–ú–∞—Ä–∏–Ω–∞ –ó."},
    {"rating": 5, "text": "–û—Ç–ª–∏—á–Ω—ã–π —Ç–æ–≤–∞—Ä! –í—Å–µ –Ω–∞ –≤—ã—Å—à–µ–º —É—Ä–æ–≤–Ω–µ. –ö–∞—á–µ—Å—Ç–≤–æ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ–µ, –¥–æ—Å—Ç–∞–≤–∫–∞ –±—ã—Å—Ç—Ä–∞—è, —É–ø–∞–∫–æ–≤–∫–∞ —Ü–µ–ª–∞—è. –û—á–µ–Ω—å –¥–æ–≤–æ–ª–µ–Ω!", "author": "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –ö."},
    {"rating": 2, "text": "–ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é. –¢–æ–≤–∞—Ä –Ω–µ –æ–ø—Ä–∞–≤–¥–∞–ª –æ–∂–∏–¥–∞–Ω–∏–π, –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∏–∑–∫–æ–µ. –õ—É—á—à–µ –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å –¥–µ–Ω—å–≥–∏ –Ω–∞ —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ.", "author": "–í–∞–ª–µ–Ω—Ç–∏–Ω–∞ –ü."},
    {"rating": 4, "text": "–ù–µ–ø–ª–æ—Ö–æ–π —Ç–æ–≤–∞—Ä –∑–∞ —Å–≤–æ—é —Ü–µ–Ω—É. –ï—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏, –Ω–æ –≤ —Ü–µ–ª–æ–º –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å. –†–µ–∫–æ–º–µ–Ω–¥—É—é.", "author": "–ê—Ä—Ç–µ–º –°."},
]


def init_test_data():
    """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""
    db = SessionLocal()
    
    try:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ç–æ–≤–∞—Ä
        test_product = db.query(Product).filter(
            Product.url == "https://www.wildberries.ru/catalog/test/product"
        ).first()
        
        if test_product:
            print(f"‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π —Ç–æ–≤–∞—Ä —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (ID: {test_product.id})")
            # –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –æ—Ç–∑—ã–≤—ã
            db.query(Review).filter(Review.product_id == test_product.id).delete()
            db.commit()
            product_id = test_product.id
        else:
            # –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —Ç–æ–≤–∞—Ä
            test_product = Product(
                user_id=1,  # –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ –µ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å ID=1
                name="–¢–µ—Å—Ç–æ–≤—ã–π —Ç–æ–≤–∞—Ä –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–Ω–∞–ª–∏–∑–∞ –æ—Ç–∑—ã–≤–æ–≤",
                url="https://www.wildberries.ru/catalog/test/product",
                marketplace="wildberries",
                parsing_status="completed",
                last_parsed_at=datetime.utcnow()
            )
            db.add(test_product)
            db.commit()
            db.refresh(test_product)
            product_id = test_product.id
            print(f"‚úÖ –°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Ç–æ–≤–∞—Ä (ID: {product_id})")
        
        # –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç–∑—ã–≤—ã —Å —Ä–∞–∑–Ω—ã–º–∏ –¥–∞—Ç–∞–º–∏ (–∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞)
        base_date = datetime.utcnow()
        reviews_added = 0
        
        for i, review_data in enumerate(TEST_REVIEWS):
            # –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–∞—Ç—ã —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞
            days_ago = (i * 3) % 90  # –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –∑–∞ 90 –¥–Ω–µ–π
            review_date = base_date - timedelta(days=days_ago)
            
            review = Review(
                product_id=product_id,
                author=review_data["author"],
                rating=review_data["rating"],
                text=review_data["text"],
                date=review_date
            )
            db.add(review)
            reviews_added += 1
        
        db.commit()
        print(f"‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ {reviews_added} —Ç–µ—Å—Ç–æ–≤—ã—Ö –æ—Ç–∑—ã–≤–æ–≤")
        print(f"üìä –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ä–µ–π—Ç–∏–Ω–≥–∞–º:")
        print(f"   - 5 –∑–≤–µ–∑–¥: {sum(1 for r in TEST_REVIEWS if r['rating'] == 5)}")
        print(f"   - 4 –∑–≤–µ–∑–¥—ã: {sum(1 for r in TEST_REVIEWS if r['rating'] == 4)}")
        print(f"   - 3 –∑–≤–µ–∑–¥—ã: {sum(1 for r in TEST_REVIEWS if r['rating'] == 3)}")
        print(f"   - 2 –∑–≤–µ–∑–¥—ã: {sum(1 for r in TEST_REVIEWS if r['rating'] == 2)}")
        print(f"   - 1 –∑–≤–µ–∑–¥–∞: {sum(1 for r in TEST_REVIEWS if r['rating'] == 1)}")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: {e}")
        import traceback
        print(traceback.format_exc())
        db.rollback()
    finally:
        db.close()


if __name__ == "__main__":
    print("üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö...")
    init_test_data()
    print("‚úÖ –ì–æ—Ç–æ–≤–æ!")

